var today=new Date,dd=today.getDate(),mm=today.getMonth()+1,yyyy=today.getFullYear();dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm);var map,version=yyyy+mm+dd,foursquareCID="PEFOBDYIB3ZSYB2EZAIW2BMA0F14OZZCW214UESFUJD0JNUA",foursquareSecret="3UJHPJIXQ04JLHBQLN0MORHTUDDSRSKAN2LU0VV4J3SL2XV2",foursquareAPI="https://api.foursquare.com/v2/venues/search?client_id="+foursquareCID+"&client_secret="+foursquareSecret+"&v="+version,googleMapsAPIKey="AIzaSyBKeH6OCP82sNs5S2Hn1kI4Xg1uXUkbZPU",googleStreetViewURL="https://maps.googleapis.com/maps/api/streetview",centerLat=39.566631,centerLng=-104.872287,breweryPlaceData=[{name:"Dry Dock Brewing Company - South Dock",location:{lat:39.652665,lng:-104.81204},type:"Taproom"},{name:"Dry Dock Brewing Company - North Dock",location:{lat:39.756624,lng:-104.773515},type:"Taproom"},{name:"Copper Kettle Brewing Company",location:{lat:39.692681,lng:-104.891341},type:"Taproom"},{name:"Comrade Brewing Company",location:{lat:39.675659,lng:-104.898488},type:"Taproom"},{name:"Peak to Peak Tap & Brew",location:{lat:39.674087,lng:-104.793862},type:"Brewpub"},{name:"Declaration Brewing Company",location:{lat:39.679765,lng:-104.990782},type:"Taproom"},{name:"True Brewing Company",location:{lat:39.719919,lng:-104.987686},type:"Taproom"},{name:"Living the Dream Brewing",location:{lat:39.540528,lng:-105.039922},type:"Taproom"},{name:"Grist Brewing Company",location:{lat:39.549058,lng:-105.033849},type:"Taproom"},{name:"Ursula Brewing",location:{lat:39.748301,lng:-104.838031},type:"Taproom"},{name:"Launch Pad Brewery",location:{lat:39.700827,lng:-104.789906},type:"Taproom"},{name:"Lone Tree Brewing Company",location:{lat:39.562658,lng:-104.892868},type:"Taproom"},{name:"105 West Brewing Company",location:{lat:39.380952,lng:-104.867617},type:"Taproom"},{name:"Locavore Beer Works",location:{lat:39.608641,lng:-105.036131},type:"Taproom"},{name:"38 State Brewing Company",location:{lat:39.568826,lng:-104.989762},type:"Taproom"},{name:"Halfpenny Brewing Company",location:{lat:39.593525,lng:-104.927406},type:"Taproom"},{name:"Blue Spruce Brewing Company",location:{lat:39.56691,lng:-104.939904},type:"Brewpub"},{name:"Rockyard American Grill and Brewing Company",location:{lat:39.409238,lng:-104.869859},type:"Brewpub"},{name:"Breckenridge Brewery Farm House",location:{lat:39.593803,lng:-105.023768},type:"Brewpub"},{name:"Dad & Dudes Breweria",location:{lat:39.593947,lng:-104.806407},type:"Brewpub"},{name:"Pints Pub Brewery and Freehouse",location:{lat:39.736973,lng:-104.990853},type:"Brewpub"},{name:"Vine Street Pub & Brewery",location:{lat:39.743472,lng:-104.961993},type:"Brewpub"},{name:"FanDraught Sports Brewery",location:{lat:39.552105,lng:-104.773501},type:"Brewpub"},{name:"CB & Potts - Greenwood Village",location:{lat:39.59737,lng:-104.889576},type:"Brewpub"},{name:"CB & Potts - Highlands Ranch",location:{lat:39.562739,lng:-104.988435},type:"Brewpub"}],Place=function(e){this.name=ko.observable(e.name),this.lat=ko.observable(e.location.lat),this.lng=ko.observable(e.location.lng),this.type=ko.observable(e.type),this.marker=ko.observable()},viewModel=function(){var e,o=this;o.breweryList=ko.observableArray([]),o.visibleBreweries=ko.observableArray(),breweryPlaceData.forEach(function(e){o.breweryList.push(new Place(e))});var a=new google.maps.InfoWindow({maxWidth:300});o.breweryList().forEach(function(n){e=new google.maps.Marker({position:new google.maps.LatLng(n.lat(),n.lng()),map:map,animation:google.maps.Animation.DROP}),n.marker=e;var t=foursquareAPI+"&ll="+n.lat()+","+n.lng()+"&query='"+encodeURIComponent(n.name())+"'&limit=1",r="",l="",i=!1,s='<a href="https://www.google.com/maps/dir/Current+Location/'+n.lat()+","+n.lng()+'" target="_blank" title="Driving Directions"><span class="fas fa-car"></span></a>',m="";$.getJSON(t,function(e){var o,a,t,m,c=e.response.venues[0],p="",g="",u="",y="",w="",d="",b="";o=c.location.address,a=c.location.city,t=c.location.state,m=c.location.postalCode,g=c.contact.formattedPhone,u=c.contact.facebookUsername,y=c.contact.twitter,w=c.url,d=c.location.lat,b=c.location.lng,void 0===d&&(d=n.lat()),void 0===b&&(b=n.lng()),p=void 0!==o&&void 0!==a&&void 0!==t&&void 0!==m?o+"<br>"+a+", "+t+" "+m:"The address for this brewery was incomplete or not found.",void 0===g&&(g="A phone number for this brewery was not found."),u=void 0!==u?' <a href="https://www.facebook.com/'+u+'" target="_blank" title="Facebook"><span class="fab fa-facebook mr-2"></span></a>':"",y=void 0!==y?' <a href="https://www.twitter.com/'+y+'" target="_blank" title="Twitter"><span class="fab fa-twitter mr-2"></span></a>':"",w=void 0!==w?' <a href="'+w+'" target="_blank" title="Website"><span class="fas fa-link mr-2"></span></a>':"",r="<p>"+p+"<br>"+g+(void 0!==u||void 0!==y||void 0!==w?"</p><p>":"")+u+y+w+s+"</p>";var f=googleStreetViewURL+"/metadata?location="+d+","+b+"&key="+googleMapsAPIKey;console.log(f),$.getJSON(f,function(e){var o=e.status;console.log(o),"OK"===o&&(l='<p><img src="'+googleStreetViewURL+"?location="+d+","+b+"&size=275x150&key="+googleMapsAPIKey+'"></p>',console.log(l)),i=!0,console.log("Success: "+n.name())}).done(function(){console.log("Second Metadata Success: "+n.name())}).fail(function(){console.log("Metadata Error: "+n.name()),i=!1}).always(function(){console.log("Metadata Complete: "+n.name())})}).done(function(){console.log("Second Success: "+n.name())}).fail(function(){console.log("Error: "+n.name()),r="<p>Data could not be retrieved from Foursquare.</p>",i=!1}).always(function(){console.log("Complete: "+n.name())}),google.maps.event.addListener(n.marker,"click",function(){i&&(m='<small><em>Address, phone number and other data provided by <a href="https://foursquare.com" target="_blank">Foursquare</a></em>.'),""===r&&(r=s);var e="<div><h4>"+n.name()+"</h4><h6>"+n.type()+"</h6>"+l+r+m+"</div>";null!==n.marker.getAnimation()?n.marker.setAnimation(null):(n.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.marker.setAnimation(null)},2100)),a.setContent(e),a.open(map,n.marker),map.panTo(n.marker.position)}),o.showBreweryInfo=function(e){google.maps.event.trigger(e.marker,"click")},o.visibleBreweries.push(n)}),o.visibleBreweries(o.visibleBreweries().sort(function(e,o){return e.name<o.name?-1:e.name>o.name?1:0})),o.clearSearchboxes=function(){document.getElementById("searchbox-sm-screen").value="",document.getElementById("searchbox-lg-screen").value=""},o.userInput=ko.observable(""),o.filterBreweries=function(){var e=o.userInput().toLowerCase();o.visibleBreweries.removeAll(),a.close(),o.breweryList().forEach(function(a){a.marker.setVisible(!1),-1!==a.name().toLowerCase().indexOf(e)&&o.visibleBreweries.push(a)}),o.visibleBreweries().forEach(function(e){e.marker.setVisible(!0)})},o.clearForm=function(){o.clearSearchboxes(),o.visibleBreweries.removeAll(),a.close(),o.visibleBreweries(o.visibleBreweries().sort(function(e,o){return e.name<o.name?-1:e.name>o.name?1:0})),o.breweryList().forEach(function(e){e.marker.setVisible(!0),o.visibleBreweries.push(e)})},o.toggleButton=function(e){o.visibleBreweries.removeAll(),a.close(),o.clearSearchboxes(),o.breweryList().forEach(function(a){a.marker.setVisible(!1),a.type()===e?o.visibleBreweries.push(a):"All"===e&&o.visibleBreweries.push(a)}),o.visibleBreweries().forEach(function(e){e.marker.setVisible(!0)})}};function initMap(){"use strict";try{map=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(centerLat,centerLng),zoom:11,zoomControl:!0,scaleControl:!0,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:["roadmap","terrain","hybrid","satellite"]}})}catch(e){alert("Google Map load failure. Please check your internet connection!")}google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)}),ko.applyBindings(new viewModel)}